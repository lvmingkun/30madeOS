     1 00000000                                 [FORMAT "WCOFF"]
     2 00000000                                 [INSTRSET "i486p"]
     3 00000000                                 [OPTIMIZE 1]
     4 00000000                                 [OPTION 1]
     5 00000000                                 [BITS 32]
     6 00000000                                 	EXTERN	_memman_alloc_4k
     7 00000000                                 	EXTERN	_memman_free_4k
     8 00000000                                 [FILE "sheet.c"]
     9                                          [SECTION .text]
    10 00000000                                 	GLOBAL	_shtctl_init
    11 00000000                                 _shtctl_init:
    12 00000000 55                              	PUSH	EBP
    13 00000001 89 E5                           	MOV	EBP,ESP
    14 00000003 57                              	PUSH	EDI
    15 00000004 56                              	PUSH	ESI
    16 00000005 53                              	PUSH	EBX
    17 00000006 8B 75 08                        	MOV	ESI,DWORD [8+EBP]
    18 00000009 68 00002814                     	PUSH	10260
    19 0000000E 8B 7D 10                        	MOV	EDI,DWORD [16+EBP]
    20 00000011 56                              	PUSH	ESI
    21 00000012 E8 [00000000]                   	CALL	_memman_alloc_4k
    22 00000017 89 C3                           	MOV	EBX,EAX
    23 00000019 58                              	POP	EAX
    24 0000001A 5A                              	POP	EDX
    25 0000001B 85 DB                           	TEST	EBX,EBX
    26 0000001D 74 4A                           	JE	L3
    27 0000001F 8B 45 14                        	MOV	EAX,DWORD [20+EBP]
    28 00000022 0F AF C7                        	IMUL	EAX,EDI
    29 00000025 50                              	PUSH	EAX
    30 00000026 56                              	PUSH	ESI
    31 00000027 E8 [00000000]                   	CALL	_memman_alloc_4k
    32 0000002C 85 C0                           	TEST	EAX,EAX
    33 0000002E 89 43 04                        	MOV	DWORD [4+EBX],EAX
    34 00000031 5A                              	POP	EDX
    35 00000032 59                              	POP	ECX
    36 00000033 74 3E                           	JE	L11
    37 00000035 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
    38 00000038 89 7B 08                        	MOV	DWORD [8+EBX],EDI
    39 0000003B 89 03                           	MOV	DWORD [EBX],EAX
    40 0000003D 8D 93 000023DC                  	LEA	EDX,DWORD [9180+EBX]
    41 00000043 8B 45 14                        	MOV	EAX,DWORD [20+EBP]
    42 00000046 89 43 0C                        	MOV	DWORD [12+EBX],EAX
    43 00000049 89 D8                           	MOV	EAX,EBX
    44 0000004B C7 43 10 FFFFFFFF               	MOV	DWORD [16+EBX],-1
    45 00000052                                 L9:
    46 00000052 C7 80 00000430 00000000         	MOV	DWORD [1072+EAX],0
    47 0000005C 89 98 00000434                  	MOV	DWORD [1076+EAX],EBX
    48 00000062 83 C0 24                        	ADD	EAX,36
    49 00000065 39 D0                           	CMP	EAX,EDX
    50 00000067 7E E9                           	JLE	L9
    51 00000069                                 L3:
    52 00000069 8D 65 F4                        	LEA	ESP,DWORD [-12+EBP]
    53 0000006C 89 D8                           	MOV	EAX,EBX
    54 0000006E 5B                              	POP	EBX
    55 0000006F 5E                              	POP	ESI
    56 00000070 5F                              	POP	EDI
    57 00000071 5D                              	POP	EBP
    58 00000072 C3                              	RET
    59 00000073                                 L11:
    60 00000073 68 00002814                     	PUSH	10260
    61 00000078 53                              	PUSH	EBX
    62 00000079 56                              	PUSH	ESI
    63 0000007A E8 [00000000]                   	CALL	_memman_free_4k
    64 0000007F 83 C4 0C                        	ADD	ESP,12
    65 00000082 EB E5                           	JMP	L3
    66 00000084                                 	GLOBAL	_sheet_alloc
    67 00000084                                 _sheet_alloc:
    68 00000084 55                              	PUSH	EBP
    69 00000085 31 D2                           	XOR	EDX,EDX
    70 00000087 89 E5                           	MOV	EBP,ESP
    71 00000089 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
    72 0000008C 05 00000414                     	ADD	EAX,1044
    73 00000091                                 L18:
    74 00000091 83 78 1C 00                     	CMP	DWORD [28+EAX],0
    75 00000095 74 10                           	JE	L21
    76 00000097 42                              	INC	EDX
    77 00000098 83 C0 24                        	ADD	EAX,36
    78 0000009B 81 FA 000000FF                  	CMP	EDX,255
    79 000000A1 7E EE                           	JLE	L18
    80 000000A3 31 C0                           	XOR	EAX,EAX
    81 000000A5                                 L12:
    82 000000A5 5D                              	POP	EBP
    83 000000A6 C3                              	RET
    84 000000A7                                 L21:
    85 000000A7 C7 40 1C 00000001               	MOV	DWORD [28+EAX],1
    86 000000AE C7 40 18 FFFFFFFF               	MOV	DWORD [24+EAX],-1
    87 000000B5 EB EE                           	JMP	L12
    88 000000B7                                 	GLOBAL	_sheet_setbuf
    89 000000B7                                 _sheet_setbuf:
    90 000000B7 55                              	PUSH	EBP
    91 000000B8 89 E5                           	MOV	EBP,ESP
    92 000000BA 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
    93 000000BD 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
    94 000000C0 89 02                           	MOV	DWORD [EDX],EAX
    95 000000C2 8B 45 10                        	MOV	EAX,DWORD [16+EBP]
    96 000000C5 89 42 04                        	MOV	DWORD [4+EDX],EAX
    97 000000C8 8B 45 14                        	MOV	EAX,DWORD [20+EBP]
    98 000000CB 89 42 08                        	MOV	DWORD [8+EDX],EAX
    99 000000CE 8B 45 18                        	MOV	EAX,DWORD [24+EBP]
   100 000000D1 89 42 14                        	MOV	DWORD [20+EDX],EAX
   101 000000D4 5D                              	POP	EBP
   102 000000D5 C3                              	RET
   103 000000D6                                 	GLOBAL	_sheet_refreshsub
   104 000000D6                                 _sheet_refreshsub:
   105 000000D6 55                              	PUSH	EBP
   106 000000D7 89 E5                           	MOV	EBP,ESP
   107 000000D9 57                              	PUSH	EDI
   108 000000DA 56                              	PUSH	ESI
   109 000000DB 53                              	PUSH	EBX
   110 000000DC 83 EC 2C                        	SUB	ESP,44
   111 000000DF 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
   112 000000E2 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
   113 000000E5 83 7D 0C 00                     	CMP	DWORD [12+EBP],0
   114 000000E9 8B 00                           	MOV	EAX,DWORD [EAX]
   115 000000EB 8B 52 04                        	MOV	EDX,DWORD [4+EDX]
   116 000000EE 89 45 DC                        	MOV	DWORD [-36+EBP],EAX
   117 000000F1 89 55 D8                        	MOV	DWORD [-40+EBP],EDX
   118 000000F4 0F 88 00000133                  	JS	L54
   119 000000FA                                 L24:
   120 000000FA 83 7D 10 00                     	CMP	DWORD [16+EBP],0
   121 000000FE 0F 88 0000011D                  	JS	L55
   122 00000104                                 L25:
   123 00000104 8B 75 08                        	MOV	ESI,DWORD [8+EBP]
   124 00000107 8B 46 08                        	MOV	EAX,DWORD [8+ESI]
   125 0000010A 39 45 14                        	CMP	DWORD [20+EBP],EAX
   126 0000010D 7E 03                           	JLE	L26
   127 0000010F 89 45 14                        	MOV	DWORD [20+EBP],EAX
   128 00000112                                 L26:
   129 00000112 8B 7D 08                        	MOV	EDI,DWORD [8+EBP]
   130 00000115 8B 47 0C                        	MOV	EAX,DWORD [12+EDI]
   131 00000118 39 45 18                        	CMP	DWORD [24+EBP],EAX
   132 0000011B 7E 03                           	JLE	L27
   133 0000011D 89 45 18                        	MOV	DWORD [24+EBP],EAX
   134 00000120                                 L27:
   135 00000120 8B 45 1C                        	MOV	EAX,DWORD [28+EBP]
   136 00000123 8B 55 20                        	MOV	EDX,DWORD [32+EBP]
   137 00000126 89 45 F0                        	MOV	DWORD [-16+EBP],EAX
   138 00000129 39 D0                           	CMP	EAX,EDX
   139 0000012B 0F 8F 000000BC                  	JG	L49
   140 00000131                                 L47:
   141 00000131 8B 7D 08                        	MOV	EDI,DWORD [8+EBP]
   142 00000134 8B 75 F0                        	MOV	ESI,DWORD [-16+EBP]
   143 00000137 8B 4D 10                        	MOV	ECX,DWORD [16+EBP]
   144 0000013A 8B 5C B7 14                     	MOV	EBX,DWORD [20+EDI+ESI*4]
   145 0000013E 8B 75 14                        	MOV	ESI,DWORD [20+EBP]
   146 00000141 8B 03                           	MOV	EAX,DWORD [EBX]
   147 00000143 8B 53 10                        	MOV	EDX,DWORD [16+EBX]
   148 00000146 89 45 E0                        	MOV	DWORD [-32+EBP],EAX
   149 00000149 29 D1                           	SUB	ECX,EDX
   150 0000014B 89 D8                           	MOV	EAX,EBX
   151 0000014D 29 F8                           	SUB	EAX,EDI
   152 0000014F 8B 7D 18                        	MOV	EDI,DWORD [24+EBP]
   153 00000152 2D 00000414                     	SUB	EAX,1044
   154 00000157 29 D7                           	SUB	EDI,EDX
   155 00000159 C1 F8 02                        	SAR	EAX,2
   156 0000015C 8B 55 0C                        	MOV	EDX,DWORD [12+EBP]
   157 0000015F 69 C0 38E38E39                  	IMUL	EAX,EAX,954437177
   158 00000165 88 45 D7                        	MOV	BYTE [-41+EBP],AL
   159 00000168 89 7D C8                        	MOV	DWORD [-56+EBP],EDI
   160 0000016B 8B 43 0C                        	MOV	EAX,DWORD [12+EBX]
   161 0000016E 29 C6                           	SUB	ESI,EAX
   162 00000170 29 C2                           	SUB	EDX,EAX
   163 00000172 89 75 E4                        	MOV	DWORD [-28+EBP],ESI
   164 00000175 89 55 E8                        	MOV	DWORD [-24+EBP],EDX
   165 00000178 0F 88 00000097                  	JS	L56
   166 0000017E                                 L32:
   167 0000017E 85 C9                           	TEST	ECX,ECX
   168 00000180 0F 88 00000088                  	JS	L57
   169 00000186                                 L33:
   170 00000186 8B 43 04                        	MOV	EAX,DWORD [4+EBX]
   171 00000189 39 45 E4                        	CMP	DWORD [-28+EBP],EAX
   172 0000018C 7E 03                           	JLE	L34
   173 0000018E 89 45 E4                        	MOV	DWORD [-28+EBP],EAX
   174 00000191                                 L34:
   175 00000191 8B 43 08                        	MOV	EAX,DWORD [8+EBX]
   176 00000194 39 45 C8                        	CMP	DWORD [-56+EBP],EAX
   177 00000197 7E 03                           	JLE	L35
   178 00000199 89 45 C8                        	MOV	DWORD [-56+EBP],EAX
   179 0000019C                                 L35:
   180 0000019C 89 CE                           	MOV	ESI,ECX
   181 0000019E 3B 4D C8                        	CMP	ECX,DWORD [-56+EBP]
   182 000001A1 7D 3B                           	JGE	L51
   183 000001A3                                 L46:
   184 000001A3 8B 7B 10                        	MOV	EDI,DWORD [16+EBX]
   185 000001A6 8B 4D E8                        	MOV	ECX,DWORD [-24+EBP]
   186 000001A9 01 F7                           	ADD	EDI,ESI
   187 000001AB 3B 4D E4                        	CMP	ECX,DWORD [-28+EBP]
   188 000001AE 89 7D EC                        	MOV	DWORD [-20+EBP],EDI
   189 000001B1 7D 25                           	JGE	L53
   190 000001B3                                 L45:
   191 000001B3 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
   192 000001B6 8B 7D EC                        	MOV	EDI,DWORD [-20+EBP]
   193 000001B9 8B 43 0C                        	MOV	EAX,DWORD [12+EBX]
   194 000001BC 0F AF 7A 08                     	IMUL	EDI,DWORD [8+EDX]
   195 000001C0 01 C8                           	ADD	EAX,ECX
   196 000001C2 8A 55 D7                        	MOV	DL,BYTE [-41+EBP]
   197 000001C5 01 F8                           	ADD	EAX,EDI
   198 000001C7 8B 7D D8                        	MOV	EDI,DWORD [-40+EBP]
   199 000001CA 89 45 CC                        	MOV	DWORD [-52+EBP],EAX
   200 000001CD 38 14 38                        	CMP	BYTE [EAX+EDI*1],DL
   201 000001D0 74 23                           	JE	L58
   202 000001D2                                 L42:
   203 000001D2 41                              	INC	ECX
   204 000001D3 3B 4D E4                        	CMP	ECX,DWORD [-28+EBP]
   205 000001D6 7C DB                           	JL	L45
   206 000001D8                                 L53:
   207 000001D8 46                              	INC	ESI
   208 000001D9 3B 75 C8                        	CMP	ESI,DWORD [-56+EBP]
   209 000001DC 7C C5                           	JL	L46
   210 000001DE                                 L51:
   211 000001DE 8B 75 20                        	MOV	ESI,DWORD [32+EBP]
   212 000001E1 FF 45 F0                        	INC	DWORD [-16+EBP]
   213 000001E4 39 75 F0                        	CMP	DWORD [-16+EBP],ESI
   214 000001E7 0F 8E FFFFFF44                  	JLE	L47
   215 000001ED                                 L49:
   216 000001ED 83 C4 2C                        	ADD	ESP,44
   217 000001F0 5B                              	POP	EBX
   218 000001F1 5E                              	POP	ESI
   219 000001F2 5F                              	POP	EDI
   220 000001F3 5D                              	POP	EBP
   221 000001F4 C3                              	RET
   222 000001F5                                 L58:
   223 000001F5 89 F0                           	MOV	EAX,ESI
   224 000001F7 8B 55 E0                        	MOV	EDX,DWORD [-32+EBP]
   225 000001FA 0F AF 43 04                     	IMUL	EAX,DWORD [4+EBX]
   226 000001FE 01 C8                           	ADD	EAX,ECX
   227 00000200 8B 7D DC                        	MOV	EDI,DWORD [-36+EBP]
   228 00000203 8A 04 10                        	MOV	AL,BYTE [EAX+EDX*1]
   229 00000206 8B 55 CC                        	MOV	EDX,DWORD [-52+EBP]
   230 00000209 88 04 3A                        	MOV	BYTE [EDX+EDI*1],AL
   231 0000020C EB C4                           	JMP	L42
   232 0000020E                                 L57:
   233 0000020E 31 C9                           	XOR	ECX,ECX
   234 00000210 E9 FFFFFF71                     	JMP	L33
   235 00000215                                 L56:
   236 00000215 C7 45 E8 00000000               	MOV	DWORD [-24+EBP],0
   237 0000021C E9 FFFFFF5D                     	JMP	L32
   238 00000221                                 L55:
   239 00000221 C7 45 10 00000000               	MOV	DWORD [16+EBP],0
   240 00000228 E9 FFFFFED7                     	JMP	L25
   241 0000022D                                 L54:
   242 0000022D C7 45 0C 00000000               	MOV	DWORD [12+EBP],0
   243 00000234 E9 FFFFFEC1                     	JMP	L24
   244 00000239                                 	GLOBAL	_sheet_updown
   245 00000239                                 _sheet_updown:
   246 00000239 55                              	PUSH	EBP
   247 0000023A 89 E5                           	MOV	EBP,ESP
   248 0000023C 57                              	PUSH	EDI
   249 0000023D 56                              	PUSH	ESI
   250 0000023E 53                              	PUSH	EBX
   251 0000023F 51                              	PUSH	ECX
   252 00000240 8B 7D 08                        	MOV	EDI,DWORD [8+EBP]
   253 00000243 8B 5D 0C                        	MOV	EBX,DWORD [12+EBP]
   254 00000246 8B 77 20                        	MOV	ESI,DWORD [32+EDI]
   255 00000249 8B 47 18                        	MOV	EAX,DWORD [24+EDI]
   256 0000024C 89 45 F0                        	MOV	DWORD [-16+EBP],EAX
   257 0000024F 8B 46 10                        	MOV	EAX,DWORD [16+ESI]
   258 00000252 40                              	INC	EAX
   259 00000253 39 C3                           	CMP	EBX,EAX
   260 00000255 7E 02                           	JLE	L60
   261 00000257 89 C3                           	MOV	EBX,EAX
   262 00000259                                 L60:
   263 00000259 83 FB FF                        	CMP	EBX,-1
   264 0000025C 7D 03                           	JGE	L61
   265 0000025E 83 CB FF                        	OR	EBX,-1
   266 00000261                                 L61:
   267 00000261 89 5F 18                        	MOV	DWORD [24+EDI],EBX
   268 00000264 39 5D F0                        	CMP	DWORD [-16+EBP],EBX
   269 00000267 0F 8E 000000C9                  	JLE	L62
   270 0000026D 85 DB                           	TEST	EBX,EBX
   271 0000026F 0F 88 0000009C                  	JS	L63
   272 00000275 8B 4D F0                        	MOV	ECX,DWORD [-16+EBP]
   273 00000278                                 L68:
   274 00000278 8B 44 8E 10                     	MOV	EAX,DWORD [16+ESI+ECX*4]
   275 0000027C 89 44 8E 14                     	MOV	DWORD [20+ESI+ECX*4],EAX
   276 00000280 89 48 18                        	MOV	DWORD [24+EAX],ECX
   277 00000283 49                              	DEC	ECX
   278 00000284 39 D9                           	CMP	ECX,EBX
   279 00000286 7F F0                           	JG	L68
   280 00000288 89 7C 9E 14                     	MOV	DWORD [20+ESI+EBX*4],EDI
   281 0000028C 43                              	INC	EBX
   282 0000028D 53                              	PUSH	EBX
   283 0000028E 8B 4F 10                        	MOV	ECX,DWORD [16+EDI]
   284 00000291 89 C8                           	MOV	EAX,ECX
   285 00000293 03 47 08                        	ADD	EAX,DWORD [8+EDI]
   286 00000296 50                              	PUSH	EAX
   287 00000297 8B 57 0C                        	MOV	EDX,DWORD [12+EDI]
   288 0000029A 89 D0                           	MOV	EAX,EDX
   289 0000029C 03 47 04                        	ADD	EAX,DWORD [4+EDI]
   290 0000029F 50                              	PUSH	EAX
   291 000002A0 51                              	PUSH	ECX
   292 000002A1 52                              	PUSH	EDX
   293 000002A2 56                              	PUSH	ESI
   294 000002A3 E8 00000202                     	CALL	_sheet_refreshmap
   295 000002A8 FF 75 F0                        	PUSH	DWORD [-16+EBP]
   296 000002AB 53                              	PUSH	EBX
   297 000002AC 8B 4F 10                        	MOV	ECX,DWORD [16+EDI]
   298 000002AF 89 C8                           	MOV	EAX,ECX
   299 000002B1 03 47 08                        	ADD	EAX,DWORD [8+EDI]
   300 000002B4 50                              	PUSH	EAX
   301 000002B5 8B 57 0C                        	MOV	EDX,DWORD [12+EDI]
   302 000002B8 89 D0                           	MOV	EAX,EDX
   303 000002BA 03 47 04                        	ADD	EAX,DWORD [4+EDI]
   304 000002BD 50                              	PUSH	EAX
   305 000002BE 51                              	PUSH	ECX
   306 000002BF 52                              	PUSH	EDX
   307 000002C0 56                              	PUSH	ESI
   308 000002C1 E8 FFFFFE10                     	CALL	_sheet_refreshsub
   309 000002C6 83 C4 34                        	ADD	ESP,52
   310 000002C9                                 L69:
   311 000002C9 6A 00                           	PUSH	0
   312 000002CB 8B 4F 10                        	MOV	ECX,DWORD [16+EDI]
   313 000002CE 89 C8                           	MOV	EAX,ECX
   314 000002D0 03 47 08                        	ADD	EAX,DWORD [8+EDI]
   315 000002D3 50                              	PUSH	EAX
   316 000002D4 8B 57 0C                        	MOV	EDX,DWORD [12+EDI]
   317 000002D7 89 D0                           	MOV	EAX,EDX
   318 000002D9 03 47 04                        	ADD	EAX,DWORD [4+EDI]
   319 000002DC 50                              	PUSH	EAX
   320 000002DD 51                              	PUSH	ECX
   321 000002DE 52                              	PUSH	EDX
   322 000002DF 56                              	PUSH	ESI
   323 000002E0 E8 000001C5                     	CALL	_sheet_refreshmap
   324 000002E5 8B 45 F0                        	MOV	EAX,DWORD [-16+EBP]
   325 000002E8 48                              	DEC	EAX
   326 000002E9 50                              	PUSH	EAX
   327 000002EA 6A 00                           	PUSH	0
   328 000002EC                                 L97:
   329 000002EC 8B 4F 10                        	MOV	ECX,DWORD [16+EDI]
   330 000002EF 89 C8                           	MOV	EAX,ECX
   331 000002F1 03 47 08                        	ADD	EAX,DWORD [8+EDI]
   332 000002F4 50                              	PUSH	EAX
   333 000002F5 8B 57 0C                        	MOV	EDX,DWORD [12+EDI]
   334 000002F8 89 D0                           	MOV	EAX,EDX
   335 000002FA 03 47 04                        	ADD	EAX,DWORD [4+EDI]
   336 000002FD 50                              	PUSH	EAX
   337 000002FE 51                              	PUSH	ECX
   338 000002FF 52                              	PUSH	EDX
   339 00000300 56                              	PUSH	ESI
   340 00000301 E8 FFFFFDD0                     	CALL	_sheet_refreshsub
   341 00000306 83 C4 34                        	ADD	ESP,52
   342 00000309                                 L59:
   343 00000309 8D 65 F4                        	LEA	ESP,DWORD [-12+EBP]
   344 0000030C 5B                              	POP	EBX
   345 0000030D 5E                              	POP	ESI
   346 0000030E 5F                              	POP	EDI
   347 0000030F 5D                              	POP	EBP
   348 00000310 C3                              	RET
   349 00000311                                 L63:
   350 00000311 8B 46 10                        	MOV	EAX,DWORD [16+ESI]
   351 00000314 3B 45 F0                        	CMP	EAX,DWORD [-16+EBP]
   352 00000317 7E 18                           	JLE	L70
   353 00000319 8B 4D F0                        	MOV	ECX,DWORD [-16+EBP]
   354 0000031C 39 C1                           	CMP	ECX,EAX
   355 0000031E 7D 11                           	JGE	L70
   356 00000320                                 L75:
   357 00000320 8B 44 8E 18                     	MOV	EAX,DWORD [24+ESI+ECX*4]
   358 00000324 89 44 8E 14                     	MOV	DWORD [20+ESI+ECX*4],EAX
   359 00000328 89 48 18                        	MOV	DWORD [24+EAX],ECX
   360 0000032B 41                              	INC	ECX
   361 0000032C 3B 4E 10                        	CMP	ECX,DWORD [16+ESI]
   362 0000032F 7C EF                           	JL	L75
   363 00000331                                 L70:
   364 00000331 FF 4E 10                        	DEC	DWORD [16+ESI]
   365 00000334 EB 93                           	JMP	L69
   366 00000336                                 L62:
   367 00000336 39 5D F0                        	CMP	DWORD [-16+EBP],EBX
   368 00000339 7D CE                           	JGE	L59
   369 0000033B 83 7D F0 00                     	CMP	DWORD [-16+EBP],0
   370 0000033F 7E 3D                           	JLE	L78
   371 00000341 8B 4D F0                        	MOV	ECX,DWORD [-16+EBP]
   372 00000344 39 D9                           	CMP	ECX,EBX
   373 00000346 7D 10                           	JGE	L94
   374 00000348                                 L83:
   375 00000348 8B 44 8E 18                     	MOV	EAX,DWORD [24+ESI+ECX*4]
   376 0000034C 89 44 8E 14                     	MOV	DWORD [20+ESI+ECX*4],EAX
   377 00000350 89 48 18                        	MOV	DWORD [24+EAX],ECX
   378 00000353 41                              	INC	ECX
   379 00000354 39 D9                           	CMP	ECX,EBX
   380 00000356 7C F0                           	JL	L83
   381 00000358                                 L94:
   382 00000358 89 7C 9E 14                     	MOV	DWORD [20+ESI+EBX*4],EDI
   383 0000035C                                 L84:
   384 0000035C 53                              	PUSH	EBX
   385 0000035D 8B 4F 10                        	MOV	ECX,DWORD [16+EDI]
   386 00000360 89 C8                           	MOV	EAX,ECX
   387 00000362 03 47 08                        	ADD	EAX,DWORD [8+EDI]
   388 00000365 50                              	PUSH	EAX
   389 00000366 8B 57 0C                        	MOV	EDX,DWORD [12+EDI]
   390 00000369 89 D0                           	MOV	EAX,EDX
   391 0000036B 03 47 04                        	ADD	EAX,DWORD [4+EDI]
   392 0000036E 50                              	PUSH	EAX
   393 0000036F 51                              	PUSH	ECX
   394 00000370 52                              	PUSH	EDX
   395 00000371 56                              	PUSH	ESI
   396 00000372 E8 00000133                     	CALL	_sheet_refreshmap
   397 00000377 53                              	PUSH	EBX
   398 00000378 53                              	PUSH	EBX
   399 00000379 E9 FFFFFF6E                     	JMP	L97
   400 0000037E                                 L78:
   401 0000037E 8B 4E 10                        	MOV	ECX,DWORD [16+ESI]
   402 00000381 39 D9                           	CMP	ECX,EBX
   403 00000383 7C 13                           	JL	L96
   404 00000385                                 L89:
   405 00000385 8B 54 8E 14                     	MOV	EDX,DWORD [20+ESI+ECX*4]
   406 00000389 8D 41 01                        	LEA	EAX,DWORD [1+ECX]
   407 0000038C 89 54 8E 18                     	MOV	DWORD [24+ESI+ECX*4],EDX
   408 00000390 49                              	DEC	ECX
   409 00000391 89 42 18                        	MOV	DWORD [24+EDX],EAX
   410 00000394 39 D9                           	CMP	ECX,EBX
   411 00000396 7D ED                           	JGE	L89
   412 00000398                                 L96:
   413 00000398 89 7C 9E 14                     	MOV	DWORD [20+ESI+EBX*4],EDI
   414 0000039C FF 46 10                        	INC	DWORD [16+ESI]
   415 0000039F EB BB                           	JMP	L84
   416 000003A1                                 	GLOBAL	_sheet_refresh
   417 000003A1                                 _sheet_refresh:
   418 000003A1 55                              	PUSH	EBP
   419 000003A2 89 E5                           	MOV	EBP,ESP
   420 000003A4 53                              	PUSH	EBX
   421 000003A5 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   422 000003A8 8B 43 18                        	MOV	EAX,DWORD [24+EBX]
   423 000003AB 85 C0                           	TEST	EAX,EAX
   424 000003AD 78 27                           	JS	L98
   425 000003AF 50                              	PUSH	EAX
   426 000003B0 50                              	PUSH	EAX
   427 000003B1 8B 4B 10                        	MOV	ECX,DWORD [16+EBX]
   428 000003B4 89 C8                           	MOV	EAX,ECX
   429 000003B6 03 4D 10                        	ADD	ECX,DWORD [16+EBP]
   430 000003B9 03 45 18                        	ADD	EAX,DWORD [24+EBP]
   431 000003BC 50                              	PUSH	EAX
   432 000003BD 8B 53 0C                        	MOV	EDX,DWORD [12+EBX]
   433 000003C0 89 D0                           	MOV	EAX,EDX
   434 000003C2 03 55 0C                        	ADD	EDX,DWORD [12+EBP]
   435 000003C5 03 45 14                        	ADD	EAX,DWORD [20+EBP]
   436 000003C8 50                              	PUSH	EAX
   437 000003C9 51                              	PUSH	ECX
   438 000003CA 52                              	PUSH	EDX
   439 000003CB FF 73 20                        	PUSH	DWORD [32+EBX]
   440 000003CE E8 FFFFFD03                     	CALL	_sheet_refreshsub
   441 000003D3 83 C4 1C                        	ADD	ESP,28
   442 000003D6                                 L98:
   443 000003D6 8B 5D FC                        	MOV	EBX,DWORD [-4+EBP]
   444 000003D9 C9                              	LEAVE
   445 000003DA C3                              	RET
   446 000003DB                                 	GLOBAL	_sheet_slide
   447 000003DB                                 _sheet_slide:
   448 000003DB 55                              	PUSH	EBP
   449 000003DC 89 E5                           	MOV	EBP,ESP
   450 000003DE 57                              	PUSH	EDI
   451 000003DF 56                              	PUSH	ESI
   452 000003E0 53                              	PUSH	EBX
   453 000003E1 53                              	PUSH	EBX
   454 000003E2 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   455 000003E5 8B 43 20                        	MOV	EAX,DWORD [32+EBX]
   456 000003E8 8B 7B 0C                        	MOV	EDI,DWORD [12+EBX]
   457 000003EB 89 45 F0                        	MOV	DWORD [-16+EBP],EAX
   458 000003EE 8B 73 10                        	MOV	ESI,DWORD [16+EBX]
   459 000003F1 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
   460 000003F4 89 43 0C                        	MOV	DWORD [12+EBX],EAX
   461 000003F7 8B 45 10                        	MOV	EAX,DWORD [16+EBP]
   462 000003FA 89 43 10                        	MOV	DWORD [16+EBX],EAX
   463 000003FD 83 7B 18 00                     	CMP	DWORD [24+EBX],0
   464 00000401 78 7C                           	JS	L100
   465 00000403 6A 00                           	PUSH	0
   466 00000405 89 F0                           	MOV	EAX,ESI
   467 00000407 03 43 08                        	ADD	EAX,DWORD [8+EBX]
   468 0000040A 50                              	PUSH	EAX
   469 0000040B 89 F8                           	MOV	EAX,EDI
   470 0000040D 03 43 04                        	ADD	EAX,DWORD [4+EBX]
   471 00000410 50                              	PUSH	EAX
   472 00000411 56                              	PUSH	ESI
   473 00000412 57                              	PUSH	EDI
   474 00000413 FF 75 F0                        	PUSH	DWORD [-16+EBP]
   475 00000416 E8 0000008F                     	CALL	_sheet_refreshmap
   476 0000041B 8B 45 10                        	MOV	EAX,DWORD [16+EBP]
   477 0000041E FF 73 18                        	PUSH	DWORD [24+EBX]
   478 00000421 03 43 08                        	ADD	EAX,DWORD [8+EBX]
   479 00000424 50                              	PUSH	EAX
   480 00000425 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
   481 00000428 03 43 04                        	ADD	EAX,DWORD [4+EBX]
   482 0000042B 50                              	PUSH	EAX
   483 0000042C FF 75 10                        	PUSH	DWORD [16+EBP]
   484 0000042F FF 75 0C                        	PUSH	DWORD [12+EBP]
   485 00000432 FF 75 F0                        	PUSH	DWORD [-16+EBP]
   486 00000435 E8 00000070                     	CALL	_sheet_refreshmap
   487 0000043A 8B 43 18                        	MOV	EAX,DWORD [24+EBX]
   488 0000043D 83 C4 30                        	ADD	ESP,48
   489 00000440 48                              	DEC	EAX
   490 00000441 50                              	PUSH	EAX
   491 00000442 89 F0                           	MOV	EAX,ESI
   492 00000444 6A 00                           	PUSH	0
   493 00000446 03 43 08                        	ADD	EAX,DWORD [8+EBX]
   494 00000449 50                              	PUSH	EAX
   495 0000044A 89 F8                           	MOV	EAX,EDI
   496 0000044C 03 43 04                        	ADD	EAX,DWORD [4+EBX]
   497 0000044F 50                              	PUSH	EAX
   498 00000450 56                              	PUSH	ESI
   499 00000451 57                              	PUSH	EDI
   500 00000452 FF 75 F0                        	PUSH	DWORD [-16+EBP]
   501 00000455 E8 FFFFFC7C                     	CALL	_sheet_refreshsub
   502 0000045A 8B 45 10                        	MOV	EAX,DWORD [16+EBP]
   503 0000045D FF 73 18                        	PUSH	DWORD [24+EBX]
   504 00000460 FF 73 18                        	PUSH	DWORD [24+EBX]
   505 00000463 03 43 08                        	ADD	EAX,DWORD [8+EBX]
   506 00000466 50                              	PUSH	EAX
   507 00000467 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
   508 0000046A 03 43 04                        	ADD	EAX,DWORD [4+EBX]
   509 0000046D 50                              	PUSH	EAX
   510 0000046E FF 75 10                        	PUSH	DWORD [16+EBP]
   511 00000471 FF 75 0C                        	PUSH	DWORD [12+EBP]
   512 00000474 FF 75 F0                        	PUSH	DWORD [-16+EBP]
   513 00000477 E8 FFFFFC5A                     	CALL	_sheet_refreshsub
   514 0000047C 83 C4 38                        	ADD	ESP,56
   515 0000047F                                 L100:
   516 0000047F 8D 65 F4                        	LEA	ESP,DWORD [-12+EBP]
   517 00000482 5B                              	POP	EBX
   518 00000483 5E                              	POP	ESI
   519 00000484 5F                              	POP	EDI
   520 00000485 5D                              	POP	EBP
   521 00000486 C3                              	RET
   522 00000487                                 	GLOBAL	_sheet_free
   523 00000487                                 _sheet_free:
   524 00000487 55                              	PUSH	EBP
   525 00000488 89 E5                           	MOV	EBP,ESP
   526 0000048A 53                              	PUSH	EBX
   527 0000048B 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   528 0000048E 83 7B 18 00                     	CMP	DWORD [24+EBX],0
   529 00000492 78 0A                           	JS	L103
   530 00000494 6A FF                           	PUSH	-1
   531 00000496 53                              	PUSH	EBX
   532 00000497 E8 FFFFFD9D                     	CALL	_sheet_updown
   533 0000049C 58                              	POP	EAX
   534 0000049D 5A                              	POP	EDX
   535 0000049E                                 L103:
   536 0000049E C7 43 1C 00000000               	MOV	DWORD [28+EBX],0
   537 000004A5 8B 5D FC                        	MOV	EBX,DWORD [-4+EBP]
   538 000004A8 C9                              	LEAVE
   539 000004A9 C3                              	RET
   540 000004AA                                 	GLOBAL	_sheet_refreshmap
   541 000004AA                                 _sheet_refreshmap:
   542 000004AA 55                              	PUSH	EBP
   543 000004AB 89 E5                           	MOV	EBP,ESP
   544 000004AD 57                              	PUSH	EDI
   545 000004AE 56                              	PUSH	ESI
   546 000004AF 53                              	PUSH	EBX
   547 000004B0 83 EC 28                        	SUB	ESP,40
   548 000004B3 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
   549 000004B6 83 7D 0C 00                     	CMP	DWORD [12+EBP],0
   550 000004BA 8B 40 04                        	MOV	EAX,DWORD [4+EAX]
   551 000004BD 89 45 D8                        	MOV	DWORD [-40+EBP],EAX
   552 000004C0 0F 88 00000135                  	JS	L135
   553 000004C6                                 L105:
   554 000004C6 83 7D 10 00                     	CMP	DWORD [16+EBP],0
   555 000004CA 0F 88 0000011F                  	JS	L136
   556 000004D0                                 L106:
   557 000004D0 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
   558 000004D3 8B 42 08                        	MOV	EAX,DWORD [8+EDX]
   559 000004D6 39 45 14                        	CMP	DWORD [20+EBP],EAX
   560 000004D9 7E 03                           	JLE	L107
   561 000004DB 89 45 14                        	MOV	DWORD [20+EBP],EAX
   562 000004DE                                 L107:
   563 000004DE 8B 75 08                        	MOV	ESI,DWORD [8+EBP]
   564 000004E1 8B 46 0C                        	MOV	EAX,DWORD [12+ESI]
   565 000004E4 39 45 18                        	CMP	DWORD [24+EBP],EAX
   566 000004E7 7E 03                           	JLE	L108
   567 000004E9 89 45 18                        	MOV	DWORD [24+EBP],EAX
   568 000004EC                                 L108:
   569 000004EC 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
   570 000004EF 8B 7D 1C                        	MOV	EDI,DWORD [28+EBP]
   571 000004F2 89 7D F0                        	MOV	DWORD [-16+EBP],EDI
   572 000004F5 3B 78 10                        	CMP	EDI,DWORD [16+EAX]
   573 000004F8 0F 8F 000000D6                  	JG	L130
   574 000004FE                                 L128:
   575 000004FE 8B 75 08                        	MOV	ESI,DWORD [8+EBP]
   576 00000501 8B 55 F0                        	MOV	EDX,DWORD [-16+EBP]
   577 00000504 8B 5D 10                        	MOV	EBX,DWORD [16+EBP]
   578 00000507 8B 4C 96 14                     	MOV	ECX,DWORD [20+ESI+EDX*4]
   579 0000050B 89 C8                           	MOV	EAX,ECX
   580 0000050D 29 F0                           	SUB	EAX,ESI
   581 0000050F 8B 39                           	MOV	EDI,DWORD [ECX]
   582 00000511 2D 00000414                     	SUB	EAX,1044
   583 00000516 8B 51 10                        	MOV	EDX,DWORD [16+ECX]
   584 00000519 C1 F8 02                        	SAR	EAX,2
   585 0000051C 89 7D E0                        	MOV	DWORD [-32+EBP],EDI
   586 0000051F 69 C0 38E38E39                  	IMUL	EAX,EAX,954437177
   587 00000525 8B 7D 18                        	MOV	EDI,DWORD [24+EBP]
   588 00000528 29 D3                           	SUB	EBX,EDX
   589 0000052A 29 D7                           	SUB	EDI,EDX
   590 0000052C 88 45 DF                        	MOV	BYTE [-33+EBP],AL
   591 0000052F 8B 75 14                        	MOV	ESI,DWORD [20+EBP]
   592 00000532 8B 55 0C                        	MOV	EDX,DWORD [12+EBP]
   593 00000535 8B 41 0C                        	MOV	EAX,DWORD [12+ECX]
   594 00000538 89 7D D4                        	MOV	DWORD [-44+EBP],EDI
   595 0000053B 29 C6                           	SUB	ESI,EAX
   596 0000053D 29 C2                           	SUB	EDX,EAX
   597 0000053F 89 75 CC                        	MOV	DWORD [-52+EBP],ESI
   598 00000542 89 55 E4                        	MOV	DWORD [-28+EBP],EDX
   599 00000545 0F 88 00000098                  	JS	L137
   600 0000054B                                 L113:
   601 0000054B 85 DB                           	TEST	EBX,EBX
   602 0000054D 0F 88 00000089                  	JS	L138
   603 00000553                                 L114:
   604 00000553 8B 41 04                        	MOV	EAX,DWORD [4+ECX]
   605 00000556 39 45 CC                        	CMP	DWORD [-52+EBP],EAX
   606 00000559 7E 03                           	JLE	L115
   607 0000055B 89 45 CC                        	MOV	DWORD [-52+EBP],EAX
   608 0000055E                                 L115:
   609 0000055E 8B 41 08                        	MOV	EAX,DWORD [8+ECX]
   610 00000561 39 45 D4                        	CMP	DWORD [-44+EBP],EAX
   611 00000564 7E 03                           	JLE	L116
   612 00000566 89 45 D4                        	MOV	DWORD [-44+EBP],EAX
   613 00000569                                 L116:
   614 00000569 3B 5D D4                        	CMP	EBX,DWORD [-44+EBP]
   615 0000056C 7D 54                           	JGE	L132
   616 0000056E                                 L127:
   617 0000056E 8B 71 10                        	MOV	ESI,DWORD [16+ECX]
   618 00000571 8B 55 E4                        	MOV	EDX,DWORD [-28+EBP]
   619 00000574 01 DE                           	ADD	ESI,EBX
   620 00000576 3B 55 CC                        	CMP	EDX,DWORD [-52+EBP]
   621 00000579 89 75 E8                        	MOV	DWORD [-24+EBP],ESI
   622 0000057C 7D 3E                           	JGE	L134
   623 0000057E                                 L126:
   624 0000057E 89 D8                           	MOV	EAX,EBX
   625 00000580 8B 79 0C                        	MOV	EDI,DWORD [12+ECX]
   626 00000583 0F AF 41 04                     	IMUL	EAX,DWORD [4+ECX]
   627 00000587 01 D7                           	ADD	EDI,EDX
   628 00000589 8B 75 E0                        	MOV	ESI,DWORD [-32+EBP]
   629 0000058C 01 D0                           	ADD	EAX,EDX
   630 0000058E 89 7D EC                        	MOV	DWORD [-20+EBP],EDI
   631 00000591 0F B6 34 30                     	MOVZX	ESI,BYTE [EAX+ESI*1]
   632 00000595 3B 71 14                        	CMP	ESI,DWORD [20+ECX]
   633 00000598 74 1C                           	JE	L123
   634 0000059A 8B 7D 08                        	MOV	EDI,DWORD [8+EBP]
   635 0000059D 8B 45 E8                        	MOV	EAX,DWORD [-24+EBP]
   636 000005A0 8B 75 D8                        	MOV	ESI,DWORD [-40+EBP]
   637 000005A3 0F AF 47 08                     	IMUL	EAX,DWORD [8+EDI]
   638 000005A7 03 45 EC                        	ADD	EAX,DWORD [-20+EBP]
   639 000005AA 89 45 D0                        	MOV	DWORD [-48+EBP],EAX
   640 000005AD 8A 45 DF                        	MOV	AL,BYTE [-33+EBP]
   641 000005B0 8B 7D D0                        	MOV	EDI,DWORD [-48+EBP]
   642 000005B3 88 04 37                        	MOV	BYTE [EDI+ESI*1],AL
   643 000005B6                                 L123:
   644 000005B6 42                              	INC	EDX
   645 000005B7 3B 55 CC                        	CMP	EDX,DWORD [-52+EBP]
   646 000005BA 7C C2                           	JL	L126
   647 000005BC                                 L134:
   648 000005BC 43                              	INC	EBX
   649 000005BD 3B 5D D4                        	CMP	EBX,DWORD [-44+EBP]
   650 000005C0 7C AC                           	JL	L127
   651 000005C2                                 L132:
   652 000005C2 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
   653 000005C5 FF 45 F0                        	INC	DWORD [-16+EBP]
   654 000005C8 8B 45 F0                        	MOV	EAX,DWORD [-16+EBP]
   655 000005CB 3B 42 10                        	CMP	EAX,DWORD [16+EDX]
   656 000005CE 0F 8E FFFFFF2A                  	JLE	L128
   657 000005D4                                 L130:
   658 000005D4 83 C4 28                        	ADD	ESP,40
   659 000005D7 5B                              	POP	EBX
   660 000005D8 5E                              	POP	ESI
   661 000005D9 5F                              	POP	EDI
   662 000005DA 5D                              	POP	EBP
   663 000005DB C3                              	RET
   664 000005DC                                 L138:
   665 000005DC 31 DB                           	XOR	EBX,EBX
   666 000005DE E9 FFFFFF70                     	JMP	L114
   667 000005E3                                 L137:
   668 000005E3 C7 45 E4 00000000               	MOV	DWORD [-28+EBP],0
   669 000005EA E9 FFFFFF5C                     	JMP	L113
   670 000005EF                                 L136:
   671 000005EF C7 45 10 00000000               	MOV	DWORD [16+EBP],0
   672 000005F6 E9 FFFFFED5                     	JMP	L106
   673 000005FB                                 L135:
   674 000005FB C7 45 0C 00000000               	MOV	DWORD [12+EBP],0
   675 00000602 E9 FFFFFEBF                     	JMP	L105
